<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>

// Create a question:
$('#create').on('submit', function(event) {
  const form = $(this).closest('form');
  event.preventDefault();
  $.ajax({method: 'post', url: '/questions', data: form.serialize()})
    .done()
    .fail(error => alert(error.responseText));
});

// delete a question
$(document).on('click', '.delete', function(event) {
   const form = $(this).closest('form');
   const question_id = form.attr('id')
   event.preventDefault();
   console.log(question_id);
   $.ajax({method: 'delete', url: `/questions/${question_id}`})
     .done(() => {
        console.log('done');
        form.remove()
        window.location.replace('/questions')
     })
     .fail(error => alert(error.responseText));
 });

// Update a question
$('.update').on('submit', function(event) {
    const form = $(this);
    console.log('in the update');
    const question_id = form.attr('id');
    event.preventDefault();
    $.ajax({method: 'put', url: `/questions/${question_id}`, data: form.serialize()})
        .fail(error => alert(error.responseText));
});

//get choice and answer from user, check if choice is correct then
$(document).on('click', '.enter', function(event) {
    const form = $(this).closest('form');
    const choice = $( "#options option:selected" , form ).text();
    const answer = $(form).attr('answer');
    const questionId = $(form).attr('id');
    const bID = "#b"+questionId;
    const divID = "#div"+questionId;

    if(choice === answer){
      const score = parseInt($('#score').attr('value')); //find current score
      var newscore = score + 1;
      $('#score').attr('value', newscore);
      $('#currscore').html(newscore);
      $(divID).html("<h2 class = \"text-success\">correct</h2>");
    }else{
      $(divID).html("<h2 class = \"text-danger\">incorrect</h2>");
    }
    $(bID).remove();

    event.preventDefault();
});


</script>
